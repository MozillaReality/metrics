{"version":3,"file":"metrics.es.js","sources":["src/lib/reporter.js","src/lib/metrics.js"],"sourcesContent":["import path from 'path';\n\nlet querystring = {};\nfunction encode (value, opts) {\n\tif (opts.encode) {\n\t\treturn opts.strict ? strictUriEncode(value) : encodeURIComponent(value);\n\t}\n\treturn value;\n}\nfunction strictUriEncode (str) {\n  return encodeURIComponent(str).replace(/[!'()*]/g, x => `%${x.charCodeAt(0).toString(16).toUpperCase()}`);\n}\nquerystring.stringify = (obj, opts) => {\n  if (!obj) {\n    return '';\n  }\n\n  var defaults = {\n    encode: true,\n    strict: true\n  };\n\n  opts = Object.assign({}, obj, defaults);\n\n  if (opts.sort === false) {\n    opts.sort = function () {};\n  }\n\n  var arrayFormatter = function (key, value) {\n    return value === null ? encode(key, opts) : [\n      encode(key, opts),\n      '=',\n      encode(value, opts)\n    ].join('');\n  };\n\n  return Object.keys(obj).sort(opts.sort).map(key => {\n    var val = obj[key];\n\n    if (val === undefined) {\n      return '';\n    }\n\n    if (val === null) {\n      return encode(key, opts);\n    }\n\n    if (Array.isArray(val)) {\n      var result = [];\n\n      val.slice().forEach(function (val2) {\n        if (val2 === undefined) {\n          return;\n        }\n\n        result.push(arrayFormatter(key, val2, result.length));\n      });\n\n      return result.join('&');\n    }\n\n    return encode(key, opts) + '=' + encode(val, opts);\n  }).filter(x => {\n    return x.length > 0;\n  }).join('&');\n};\n\nvar extend = function () {\n  var i, key, len, propertyMap, propertyMaps, target, value;\n  target = arguments[0], propertyMaps = 2 <= arguments.length ? Array.prototype.slice.call(arguments, 1) : [];\n  for (i = 0, len = propertyMaps.length; i < len; i++) {\n    propertyMap = propertyMaps[i];\n    for (key in propertyMap) {\n      value = propertyMap[key];\n      target[key] = value;\n    }\n  }\n  return target;\n};\n\nvar post = function (url) {\n  var xhr;\n  xhr = new XMLHttpRequest();\n  xhr.open('POST', url);\n  return xhr.send(null);\n};\n\nvar getReleaseChannel = function () {\n  var version = atom.getVersion();\n  if (version.indexOf('beta') > -1) {\n    return 'beta';\n  } else if (version.indexOf('dev') > -1) {\n    return 'dev';\n  } else {\n    return 'stable';\n  }\n};\n\nvar getOsArch = function () {\n  if (process.platform === 'win32' && process.env.PROCESSOR_ARCHITEW6432 === 'AMD64') {\n    return 'x64';\n  }\n  return process.arch;\n};\n\nconst Reporter = (function () {\n  function Reporter () {\n  }\n\n  Reporter.consented = function () {\n    return atom.config.get('core.telemetryConsent') === 'limited';\n  };\n\n  Reporter.sendEvent = function (category, action, label, value) {\n    var params = {\n      t: 'event',\n      ec: category,\n      ea: action\n    };\n    if (label !== null) {\n      params.el = label;\n    }\n    if (value !== null) {\n      params.ev = value;\n    }\n    return this.send(params);\n  };\n\n  Reporter.sendTiming = function (category, name, value) {\n    var params = {\n      t: 'timing',\n      utc: category,\n      utv: name,\n      utt: value\n    };\n    return this.send(params);\n  };\n\n  Reporter.sendException = function (description) {\n    var params = {\n      t: 'exception',\n      exd: description,\n      exf: atom.inDevMode() ? '0' : '1'\n    };\n    return this.send(params);\n  };\n\n  Reporter.viewNameForPaneItem = function (item) {\n    var ref;\n    if (typeof item.getViewClass === 'function') {\n      ref = item.getViewClass().name;\n    }\n    var name = ref === null ? item.constructor.name : ref;\n    var itemPath;\n    if (typeof item.getPath === 'function') {\n      itemPath = item.getPath();\n    }\n    if (!((itemPath !== null) && path.dirname(itemPath) === atom.getConfigDirPath())) {\n      return name;\n    }\n    var extension = path.extname(itemPath);\n    switch (path.basename(itemPath, extension)) {\n      case 'config':\n        if (extension === '.json' || extension === '.cson') {\n          name = 'UserConfig';\n        }\n        break;\n      case 'init':\n        if (extension === '.js' || extension === '.coffee') {\n          name = 'UserInitScript';\n        }\n        break;\n      case 'keymap':\n        if (extension === '.json' || extension === '.cson') {\n          name = 'UserKeymap';\n        }\n        break;\n      case 'snippets':\n        if (extension === '.json' || extension === '.cson') {\n          name = 'UserSnippets';\n        }\n        break;\n      case 'styles':\n        if (extension === '.css' || extension === '.less') {\n          name = 'UserStylesheet';\n        }\n    }\n    return name;\n  };\n\n  Reporter.sendPaneItem = function (item) {\n    var params = {\n      t: 'appview',\n      cd: this.viewNameForPaneItem(item)\n    };\n    var ref;\n    var grammarName = typeof item.getGrammar === 'function' ? (ref = item.getGrammar()) !== null ? ref.name : void 0 : void 0;\n    if (grammarName !== null) {\n      params.dt = grammarName;\n    }\n    return this.send(params);\n  };\n\n  Reporter.sendCommand = function (commandName) {\n    var base;\n    var params;\n    if (this.commandCount === null) {\n      this.commandCount = {};\n    }\n    if ((base = this.commandCount)[commandName] === null) {\n      base[commandName] = 0;\n    }\n    this.commandCount[commandName]++;\n    params = {\n      t: 'event',\n      ec: 'command',\n      ea: commandName.split(':')[0],\n      el: commandName,\n      ev: this.commandCount[commandName]\n    };\n    return this.send(params);\n  };\n\n  Reporter.send = function (params) {\n    if (!navigator.onLine) {\n      return;\n    }\n    extend(params, {\n      v: 1,\n      aip: 1,\n      tid: 'UA-3769691-33',\n      cid: localStorage.getItem('metrics.userId'),\n      an: 'atom',\n      av: atom.getVersion()\n    });\n    if (!Reporter.consented()) {\n      return;\n    }\n    extend(params, Reporter.consentedParams());\n    if (Reporter.isTelemetryConsentChoice(params)) {\n      return Reporter.request('https://ssl.google-analytics.com/collect?' + querystring.stringify(params));\n    }\n  };\n\n  Reporter.isTelemetryConsentChoice = function (params) {\n    return params.t === 'event' && params.ec === 'setting' && params.ea === 'core.telemetryConsent';\n  };\n\n  Reporter.request = function (url) {\n    return post(url);\n  };\n\n  Reporter.consentedParams = function () {\n    // var memUse = process.memoryUsage();\n    return {\n      // cd2: getOsArch(),\n      // cd3: process.arch,\n      // cm1: memUse.heapUsed >> 20,\n      // cm2: Math.round((memUse.heapUsed / memUse.heapTotal) * 100),\n      sr: screen.width + 'x' + screen.height,\n      vp: innerWidth + 'x' + innerHeight,\n      aiid: getReleaseChannel()\n    };\n  };\n\n  return Reporter;\n})();\n\nexport default Reporter;\n","var CompositeDisposable = require('atom').CompositeDisposable;\n\nimport path from 'path';\n\nimport Reporter from './reporter.js';\n\nvar IgnoredCommands = {\n  'vim-mode:move-up': true,\n  'vim-mode:move-down': true,\n  'vim-mode:move-left': true,\n  'vim-mode:move-right': true\n};\n\nvar PathRE = /'?((\\/|\\\\|[a-z]:\\\\)[^\\s']+)+'?/ig;\n\nvar stripPath = function (message) {\n  return message.replace(PathRE, '<path>');\n};\n\nmodule.exports = {\n  activate: function (arg) {\n    var sessionLength;\n    sessionLength = arg.sessionLength;\n    this.subscriptions = [];\n    this.shouldIncludePanesAndCommands = Math.random() < 0.05;\n    return this.ensureClientId((function (_this) {\n      return function () {\n        return _this.begin(sessionLength);\n      };\n    })(this));\n  },\n  deactivate: function () {\n    var ref;\n    return (ref = this.subscriptions) !== null ? ref.dispose() : void 0;\n  },\n  serialize: function () {\n    return {\n      sessionLength: Date.now() - this.sessionStart\n    };\n  },\n  provideReporter: function () {\n    return {\n      sendEvent: Reporter.sendEvent.bind(Reporter),\n      sendTiming: Reporter.sendTiming.bind(Reporter),\n      sendException: Reporter.sendException.bind(Reporter)\n    };\n  },\n  begin: function (sessionLength) {\n    this.sessionStart = Date.now();\n    if (sessionLength) {\n      Reporter.sendEvent('window', 'ended', null, sessionLength);\n    }\n    Reporter.sendEvent('window', 'started');\n    this.subscriptions.push(atom.onDidThrowError(function (event) {\n      var errorMessage;\n      errorMessage = event;\n      if (typeof event !== 'string') {\n        errorMessage = event.message;\n      }\n      errorMessage = stripPath(errorMessage) || 'Unknown';\n      errorMessage = errorMessage.replace('Uncaught ', '').slice(0, 150);\n      return Reporter.sendException(errorMessage);\n    }));\n    this.subscriptions.push(atom.textEditors.observe(function (editor) {\n      var grammar;\n      grammar = editor.getGrammar();\n      if (grammar) {\n        return Reporter.sendEvent('file', 'open', grammar.scopeName);\n      }\n    }));\n    this.subscriptions.push(atom.config.onDidChange('core.telemetryConsent', function (arg) {\n      var newValue = arg.newValue;\n      if (newValue !== 'undecided') {\n        return Reporter.sendEvent('setting', 'core.telemetryConsent', newValue);\n      }\n    }));\n    this.watchPaneItems();\n    this.watchCommands();\n    this.watchDeprecations();\n    if (atom.getLoadSettings().shellLoadTime !== null) {\n      Reporter.sendTiming('shell', 'load', atom.getLoadSettings().shellLoadTime);\n    }\n    return process.nextTick(function () {\n      return Reporter.sendTiming('core', 'load', atom.getWindowLoadTime());\n    });\n  },\n  ensureClientId: function (callback) {\n    if (localStorage.getItem('metrics.userId')) {\n      return callback();\n    } else if (atom.config.get('metrics.userId')) {\n      localStorage.setItem('metrics.userId', atom.config.get('metrics.userId'));\n      return callback();\n    } else {\n      return this.createClientId(function (clientId) {\n        localStorage.setItem('metrics.userId', clientId);\n        return callback();\n      });\n    }\n  },\n  createClientId: function (callback) {\n    return callback(require('node-uuid').v4());\n  },\n  getClientId: function () {\n    return localStorage.getItem('metrics.userId');\n  },\n  watchPaneItems: function () {\n    return this.subscriptions.push(atom.workspace.onDidAddPaneItem((function (_this) {\n      return function (arg) {\n        var item;\n        item = arg.item;\n        if (!_this.shouldIncludePanesAndCommands) {\n          return;\n        }\n        return Reporter.sendPaneItem(item);\n      };\n    })(this)));\n  },\n  watchCommands: function () {\n    return this.subscriptions.push(atom.commands.onWillDispatch((function (_this) {\n      return function (commandEvent) {\n        var eventName, ref;\n        if (!_this.shouldIncludePanesAndCommands) {\n          return;\n        }\n        eventName = commandEvent.type;\n        if ((ref = commandEvent.detail) !== null ? ref.jQueryTrigger : void 0) {\n          return;\n        }\n        if (eventName.startsWith('core:') || eventName.startsWith('editor:')) {\n          return;\n        }\n        if (eventName.indexOf(':') === -1) {\n          return;\n        }\n        if (eventName in IgnoredCommands) {\n          return;\n        }\n        return Reporter.sendCommand(eventName);\n      };\n    })(this)));\n  },\n  reportDeprecation: function (deprecation) {\n    var __, message, nameAndVersion, pack, packageName, ref, ref1, ref2, ref3, stack, version;\n    message = deprecation.getMessage().slice(0, 500);\n    ref = deprecation.stacks;\n    for (__ in ref) {\n      stack = ref[__];\n      packageName = (ref1 = (ref2 = stack.metadata) !== null ? ref2.packageName : void 0) !== null ? ref1 : (this.getPackageName(stack) || '').toLowerCase();\n      if (!packageName) {\n        continue;\n      }\n      if (!this.packageVersionCache[packageName]) {\n        pack = atom.packages.getLoadedPackage(packageName);\n        this.packageVersionCache[packageName] = (pack !== null ? (ref3 = pack.metadata) !== null ? ref3.version : void 0 : void 0) || 'unknown';\n      }\n      version = this.packageVersionCache[packageName];\n      nameAndVersion = packageName + '@' + version;\n      if (this.deprecationCache[nameAndVersion + message] === null) {\n        this.deprecationCache[nameAndVersion + message] = true;\n        Reporter.sendEvent('deprecation-v3', nameAndVersion, message);\n      }\n    }\n  },\n  getFileNameFromCallSite: function (callsite) {\n    var ref = callsite.fileName;\n    return ref === null ? callsite.getFileName() : ref;\n  },\n  getPackageName: function (stack) {\n    var fileName, i, j, packageName, packagePath, packagePaths, ref, relativePath;\n    packagePaths = this.getPackagePathsByPackageName();\n    for (i = j = 1, ref = stack.length; 1 <= ref ? j < ref : j > ref; i = 1 <= ref ? ++j : --j) {\n      fileName = this.getFileNameFromCallSite(stack[i]);\n      if (!fileName) {\n        return;\n      }\n      if (fileName.includes(path.sep + 'node_modules' + path.sep)) {\n        continue;\n      }\n      for (packageName in packagePaths) {\n        packagePath = packagePaths[packageName];\n        relativePath = path.relative(packagePath, fileName);\n        if (!/^\\.\\./.test(relativePath)) {\n          return packageName;\n        }\n      }\n      if (atom.getUserInitScriptPath() === fileName) {\n        return 'init-script';\n      }\n    }\n  },\n  getPackagePathsByPackageName: function () {\n    var j, len, pack, ref;\n    if (this.packagePathsByPackageName !== null) {\n      return this.packagePathsByPackageName;\n    }\n    this.packagePathsByPackageName = {};\n    ref = atom.packages.getLoadedPackages();\n    for (j = 0, len = ref.length; j < len; j++) {\n      pack = ref[j];\n      this.packagePathsByPackageName[pack.name] = pack.path;\n      if (pack.path.indexOf('.atom/dev/packages') > -1 || pack.path.indexOf('.atom/packages') > -1) {\n        this.packagePathsByPackageName[pack.name] = path.resolve(pack.path);\n      }\n    }\n    return this.packagePathsByPackageName;\n  }\n};\n"],"names":["let","querystring","encode","value","opts","strict","encodeURIComponent","replace","x","charCodeAt","toString","toUpperCase","stringify","obj","Object","assign","sort","keys","map","key","val","undefined","Array","isArray","result","slice","forEach","val2","push","join","arrayFormatter","filter","length","extend","i","len","propertyMap","propertyMaps","target","arguments","prototype","call","Reporter","consented","atom","config","get","sendEvent","category","action","label","params","t","ec","ea","el","ev","this","send","sendTiming","name","utc","utv","utt","sendException","description","exd","exf","inDevMode","viewNameForPaneItem","item","ref","getViewClass","itemPath","constructor","getPath","path","dirname","getConfigDirPath","extension","extname","basename","sendPaneItem","cd","grammarName","getGrammar","dt","sendCommand","commandName","base","commandCount","split","navigator","onLine","v","aip","tid","cid","localStorage","getItem","an","av","getVersion","consentedParams","isTelemetryConsentChoice","request","url","xhr","XMLHttpRequest","open","post","sr","screen","width","height","vp","innerWidth","innerHeight","aiid","version","indexOf","IgnoredCommands","require","vim-mode:move-up","vim-mode:move-down","vim-mode:move-left","vim-mode:move-right","PathRE","module","exports","activate","arg","sessionLength","_this","subscriptions","shouldIncludePanesAndCommands","Math","random","ensureClientId","begin","deactivate","dispose","serialize","Date","now","sessionStart","provideReporter","bind","onDidThrowError","event","errorMessage","message","textEditors","observe","editor","grammar","scopeName","onDidChange","newValue","watchPaneItems","watchCommands","watchDeprecations","getLoadSettings","shellLoadTime","process","nextTick","getWindowLoadTime","callback","setItem","createClientId","clientId","v4","getClientId","workspace","onDidAddPaneItem","commands","onWillDispatch","commandEvent","eventName","type","detail","jQueryTrigger","startsWith","reportDeprecation","deprecation","__","nameAndVersion","pack","packageName","ref1","ref2","ref3","stack","getMessage","stacks","metadata","getPackageName","toLowerCase","packageVersionCache","packages","getLoadedPackage","deprecationCache","getFileNameFromCallSite","callsite","fileName","getFileName","j","packagePaths","relativePath","getPackagePathsByPackageName","includes","sep","relative","test","getUserInitScriptPath","packagePathsByPackageName","getLoadedPackages","resolve"],"mappings":"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"}