{"version":3,"file":"metrics.umd.js","sources":["src/lib/reporter.js","src/lib/metrics.js"],"sourcesContent":["/* global localStorage, XMLHttpRequest */\nlet querystring = {};\nfunction strictUriEncode (str) {\n  return encodeURIComponent(str).replace(/[!'()*]/g, x => `%${x.charCodeAt(0).toString(16).toUpperCase()}`);\n}\nfunction encode (value, opts) {\n  if (opts.encode) {\n    return opts.strict ? strictUriEncode(value) : encodeURIComponent(value);\n  }\n  return value;\n}\nquerystring.stringify = (obj, opts) => {\n  if (!obj) {\n    return '';\n  }\n\n  const defaults = {\n    encode: true,\n    strict: true\n  };\n\n  opts = Object.assign({}, obj, defaults);\n\n  if (opts.sort === false) {\n    opts.sort = () => {};\n  }\n\n  const arrayFormatter = (key, value) => value === null ? encode(key, opts) : [\n    encode(key, opts),\n    '=',\n    encode(value, opts)\n  ].join('');\n\n  return Object.keys(obj).sort(opts.sort).map(key => {\n    const val = obj[key];\n\n    if (val === undefined) {\n      return '';\n    }\n\n    if (val === null) {\n      return encode(key, opts);\n    }\n\n    if (Array.isArray(val)) {\n      const result = [];\n\n      val.slice().forEach(val2 => {\n        if (val2 === undefined) {\n          return;\n        }\n\n        result.push(arrayFormatter(key, val2, result.length));\n      });\n\n      return result.join('&');\n    }\n\n    return `${encode(key, opts)}=${encode(val, opts)}`;\n  }).filter(x => {\n    return x.length > 0;\n  }).join('&');\n};\n\nconst post = (url, data = null) => {\n  if ('sendBeacon' in navigator) {\n    return navigator.sendBeacon(url, data);\n  }\n  let xhr = new XMLHttpRequest();\n  xhr.open('POST', url);\n  return xhr.send(data);\n};\n\nconst inDevMode = () => {\n  return window.isSecureContext === false || (window.location.protocol === 'http:' && window.location.port);\n};\n\nconst getDevicePixelRatio = () => {\n  return window.devicePixelRatio || 1;\n};\n\nconst getWebGLCapabilities = () => {\n  try {\n    const canvas = document.createElement('canvas');\n    const gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');\n    /* eslint-disable no-undef */\n    return (gl && gl instanceof WebGLRenderingContext) || false;\n    /* eslint-enable no-undef */\n  } catch (err) {\n    return false;\n  }\n};\n\nconst getWebGL2Capabilities = () => {\n  try {\n    const canvas = document.createElement('canvas');\n    const gl = canvas.getContext('webgl2');\n    /* eslint-disable no-undef */\n    return (gl && gl instanceof WebGL2RenderingContext) || false;\n    /* eslint-enable no-undef */\n  } catch (err) {\n    return false;\n  }\n};\n\nconst getUserAgent = () => {\n  return navigator.userAgent;\n};\n\nconst getEndianness = () => {\n  if (!window.ArrayBuffer) {\n    return 'Unknown';\n  }\n  const buffer = new ArrayBuffer(4);\n  const intView = new Uint32Array(buffer);\n  const byteView = new Uint8Array(buffer);\n  intView[0] = 1;\n  return byteView[0] === 1 ? 'little' : 'big';\n};\n\nconst Reporter = ((() => {\n  class Reporter {\n    constructor (tagId = '') {\n      if (!tagId) {\n        throw new Error('`tagId` argument required for `Reporter` (e.g., `XXXXXX-YY`)');\n      }\n      this.tagId = tagId;\n      this.consented = true;\n      try {\n        this.consented = localStorage.getItem('xrAgent.metrics.settings.consent') !== 'false';\n      } catch (err) {\n      }\n    }\n\n    setTagId (tagId = null) {\n      this.tagId = tagId;\n    }\n\n    saveConsent (consented = true) {\n      if (this.consented) {\n        return false;\n      }\n      try {\n        localStorage.setItem('xrAgent.metrics.settings.consent', consented ? 'true' : 'false');\n      } catch (err) {\n      }\n      return true;\n    }\n\n    removeConsent (consented = true) {\n      if (!this.consented) {\n        return false;\n      }\n      localStorage.removeItem('xrAgent.metrics.clientId');\n      localStorage.removeItem('xrAgent.metrics.name');\n      localStorage.removeItem('xrAgent.metrics.version');\n      localStorage.removeItem('xrAgent.metrics.settings.consent');\n      return true;\n    }\n\n    consented () {\n      if (!this.consented) {\n        return false;\n      }\n      return localStorage.getItem('xrAgent.metrics.settings.consent') !== 'false';\n    }\n\n    sendPageView (path, hostname, title, extraParams) {\n      const params = {\n        t: 'pageview',\n        path,\n        hostname,\n        title,\n        params: extraParams\n      };\n      return this.send(params);\n    }\n\n    sendEvent (category, action, label, value) {\n      const params = {\n        t: 'event',\n        ec: category,\n        ea: action\n      };\n      if (label !== null) {\n        params.el = label;\n      }\n      if (value !== null) {\n        params.ev = value;\n      }\n      return this.send(params);\n    }\n\n    sendTiming (category, name, value) {\n      const params = {\n        t: 'timing',\n        utc: category,\n        utv: name,\n        utt: value\n      };\n      return this.send(params);\n    }\n\n    sendException (description) {\n      const params = {\n        t: 'exception',\n        exd: description,\n        exf: inDevMode() ? '0' : '1'\n      };\n      return this.send(params);\n    }\n\n    sendCommand (commandName) {\n      let base;\n      let params;\n      if (this.commandCount === null) {\n        this.commandCount = {};\n      }\n      if ((base = this.commandCount)[commandName] === null) {\n        base[commandName] = 0;\n      }\n      this.commandCount[commandName]++;\n      params = {\n        t: 'event',\n        ec: 'command',\n        ea: commandName.split(':')[0],\n        el: commandName,\n        ev: this.commandCount[commandName]\n      };\n      return this.send(params);\n    }\n\n    send (params) {\n      if (!this.consented()) {\n        return;\n      }\n\n      this.tagId = params.tagId || this.tagId || localStorage.getItem('xrAgent.metrics.tagId');\n      this.clientId = this.clientId || localStorage.getItem('xrAgent.metrics.clientId');\n\n      this.dp = params.dp || params.uri || this.uri;\n      this.p = params.p || this.p || this.dp;\n\n      this.dh = params.host || params.dh || this.host;\n      this.dt = params.title || params.dt || this.title;\n      this.dr = params.referrer || params.dr || this.dr;\n      this.uip = params.remoteAddr || params.uip || this.uip;\n\n      this.xrAgentName = this.xrAgentName || localStorage.getItem('xrAgent.metrics.name');\n      this.xrAgentVersion = this.xrAgentVersion || localStorage.getItem('xrAgent.metrics.version');\n\n      if (!navigator.onLine) {\n        return;\n      }\n\n      params = Object.assign({}, params, {\n        v: 1,\n        aip: 1,\n        tid: this.tagId,\n        // cd: this.screenName,  // TODO: Add Screen Name.\n        cid: this.clientId,\n        dp: this.uri,\n        dh: this.dh,\n        dt: this.dt,\n        dr: this.dr,\n        p: this.p,\n        uip: this.remoteAddr,\n        an: this.xrAgentName,  // App Name.\n        av: this.xrAgentVersion,  // App Version.\n        aiid: ''  // TODO: Add App Installer ID.\n      });\n      params = Object.assign({}, params, this.consentedParams());\n      if (this.isTelemetryConsentChoice(params)) {\n        return this.request(`https://ssl.google-analytics.com/collect?${querystring.stringify(params)}`);\n      }\n    }\n\n    isTelemetryConsentChoice (params) {\n      return params.t === 'event' && params.ec === 'setting' && params.ea === 'xrAgent.metrics.settings.consent';\n    }\n\n    request (url) {\n      return post(url);\n    }\n\n    consentedParams () {\n      return {\n        sr: `${window.screen.width}x${window.screen.height}`,\n        vp: `${window.innerWidth}x${window.innerHeight}`,\n        dpr: getDevicePixelRatio(),\n        capvr: !!navigator.getVRDisplays,\n        capxr: !!navigator.xr,\n        capgp: !!window.Gamepad,\n        capaudio: !!window.AudioContext || !!window.webkitAudioContext,\n        capwasm: !!window.WebAssembly,\n        capric: !!window.requestIdleCallback,\n        capwebgl: getWebGLCapabilities(),\n        capwebgl2: getWebGL2Capabilities(),\n        capworker: !!window.Worker,\n        capsw: !!navigator.serviceWorker,\n        caphc: navigator.hardwareConcurrency || 0,\n        capws: !!window.WebSocket || false,\n        capwebrtc: (!!window.RTCPeerConnection && !!window.RTCDataChannelEvent) || false,\n        capendian: getEndianness(),\n        ua: getUserAgent()\n      };\n    }\n  }\n\n  return Reporter;\n}))();\n\nexport default Reporter;\n","/* global location */\nimport Reporter from './reporter.js';\n\nconst PathRE = /'?((\\/|\\\\|[a-z]:\\\\)[^\\s']+)+'?/ig;\nconst stripPath = msg => msg.replace(PathRE, '<path>');\n\nfunction uuidV4 () {\n  let uuid = '';\n  let idx;\n  let random;\n  for (ix = 0; idx < 32; idx++) {\n    random = Math.random() * 16 | 0;\n    if (idx === 8 || idx === 12 || idx === 16 || idx === 20) {\n      uuid += '-';\n    }\n    uuid += (idx == 12 ? 4 : (idx == 16 ? (random & 3 | 8) : random)).toString(16);\n  }\n  return uuid;\n}\n\nclass LS {\n  constructor (win = window, prefix = '') {\n    try {\n      this.storage = win.localStorage;\n    } catch (err) {\n      this.storage = {};\n    }\n    this.prefix = prefix || '';\n  }\n\n  get (key) {\n    try {\n      return this.storage[this.prefix + key];\n    } catch (err) {\n      return null;\n    }\n  }\n\n  set (key, value) {\n    try {\n      this.storage[this.prefix + key] = value;\n      return value;\n    } catch (err) {\n      return null;\n    }\n  }\n\n  delete (key) {\n    try {\n      delete this.storage[this.prefix + key];\n    } catch (err) {\n      return null;\n    }\n  }\n\n  clear (key) {\n    try {\n      delete this.storage;\n    } catch (err) {\n      return null;\n    }\n  }\n}\n\nclass Metrics {\n  constructor (tagId, clientId, storage, win = window, doc = document) {\n    this.tagId = tagId;\n    this.clientId = clientId;\n    this.storage = storage || new LS(win, 'xrAgent.metrics.');\n  }\n\n  activate (arg) {\n    if (!this.consented()) {\n      return false;\n    }\n    this.subscriptions = [];\n    let sessionLength = arg.sessionLength;\n    return this.ensureClientId(((_this => () => _this.begin(sessionLength)))(this));\n  }\n\n  deactivate () {\n    delete this.subscriptions;\n    this.subscriptions = [];\n  }\n\n  serialize () {\n    return {\n      sessionLength: Date.now() - this.sessionStart\n    };\n  }\n\n  provideReporter () {\n    return {\n      sendEvent: Reporter.sendEvent.bind(Reporter),\n      sendTiming: Reporter.sendTiming.bind(Reporter),\n      sendException: Reporter.sendException.bind(Reporter)\n    };\n  }\n\n  begin (sessionLength) {\n    this.sessionStart = Date.now();\n    if (sessionLength) {\n      Reporter.sendEvent('window', 'ended', null, sessionLength);\n    }\n    Reporter.sendEvent('window', 'started');\n    this.watchExceptions();\n    this.watchPageView();\n  }\n\n  ensureClientId (callback) {\n    const self = this;\n    if (self.storage.get('clientId')) {\n      return callback();\n    }\n    return this.createClientId(clientId => {\n      self.storage.set('clientId', clientId);\n      return callback();\n    });\n  }\n\n  createClientId (callback) {\n    if (this.clientId) {\n      return callback(this.clientId);\n    }\n    return callback(uuidV4);\n  }\n\n  getClientId () {\n    return this.storage.get('clientId');\n  }\n\n  getTagId () {\n    if (this.tagId) {\n      return this.tagId;\n    }\n    this.tagId = this.storage.get('tagId');\n    return this.tagId;\n  }\n\n  setTagId (tagId) {\n    this.tagId = this.storage.set('tagId', tagId);\n    return tagId;\n  }\n\n  watchExceptions () {\n    return this.subscriptions.push(() => {\n      window.addEventListener('error', event => {\n        let errMsg = event;\n        if (typeof event !== 'string') {\n          errMsg = event.message;\n        }\n        errMsg = (stripPath(errMsg) || 'Unknown').replace('Uncaught ', '').slice(0, 150);\n        return Reporter.sendException(errMsg);\n      });\n    });\n  }\n\n  watchPageView () {\n    const self = this;\n    return self.subscriptions.push(() => {\n      Reporter.sendPageView(self.win.location.pathname, self.win.location.href, self.doc.title);\n    });\n  }\n}\n\nfunction getTag (scriptUrl, win, doc) {\n  win = win || window;\n  doc = doc || document;\n  scriptUrl = scriptUrl || doc.scriptURL || (doc.currentScript && doc.currentScript.src);\n  if (!scriptUrl && doc.currentScript) {\n    scriptUrl = doc.currentScript.getAttribute('data-tag');\n  }\n  if (!scriptUrl) {\n    return null;\n  }\n  try {\n    return new win.URLSearchParams(new win.URL(scriptUrl).search).get('tag');\n  } catch (err) {\n    alert(scriptUrl);\n    return (scriptUrl.match(/[?&]tag=(.+)/i) || [])[1];\n  }\n}\n\nconst tagId = getTag(null, window, document);\nconst metrics = new Metrics(tagId, null, window, document);\nmetrics.activate();\n\nexport default metrics;\n"],"names":["let","querystring","encode","value","opts","strict","encodeURIComponent","replace","x","charCodeAt","toString","toUpperCase","stringify","obj","Object","assign","sort","keys","map","key","const","val","undefined","Array","isArray","result","slice","forEach","val2","push","join","arrayFormatter","filter","length","Reporter","tagId","Error","consented","localStorage","getItem","err","setTagId","saveConsent","this","setItem","removeConsent","removeItem","sendPageView","path","hostname","title","extraParams","send","sendEvent","category","action","label","params","el","ev","sendTiming","name","sendException","description","window","isSecureContext","location","protocol","port","sendCommand","commandName","base","commandCount","split","clientId","dp","uri","p","dh","host","dt","dr","referrer","uip","remoteAddr","xrAgentName","xrAgentVersion","navigator","onLine","consentedParams","isTelemetryConsentChoice","request","t","ec","ea","url","data","sendBeacon","xhr","XMLHttpRequest","open","post","screen","devicePixelRatio","getVRDisplays","xr","Gamepad","AudioContext","webkitAudioContext","WebAssembly","requestIdleCallback","canvas","document","createElement","gl","getContext","WebGLRenderingContext","getWebGLCapabilities","WebGL2RenderingContext","getWebGL2Capabilities","Worker","serviceWorker","hardwareConcurrency","WebSocket","RTCPeerConnection","RTCDataChannelEvent","ArrayBuffer","buffer","intView","Uint32Array","byteView","Uint8Array","getEndianness","userAgent","PathRE","uuidV4","idx","random","uuid","ix","Math","LS","win","prefix","storage","get","set","delete","clear","Metrics","doc","activate","arg","subscriptions","_this","sessionLength","ensureClientId","begin","deactivate","serialize","Date","now","sessionStart","provideReporter","bind","watchExceptions","watchPageView","callback","self","createClientId","getClientId","getTagId","addEventListener","event","msg","errMsg","message","pathname","href","metrics","scriptUrl","scriptURL","currentScript","src","getAttribute","URLSearchParams","URL","search","alert","match","getTag"],"mappings":"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"}