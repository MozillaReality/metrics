{"version":3,"file":"metrics.js","sources":["node_modules/node-uuid/uuid.js","src/lib/reporter.js","src/lib/metrics.js"],"sourcesContent":["//     uuid.js\n//\n//     Copyright (c) 2010-2012 Robert Kieffer\n//     MIT License - http://opensource.org/licenses/mit-license.php\n\n/*global window, require, define */\n(function(_window) {\n  'use strict';\n\n  // Unique ID creation requires a high quality random # generator.  We feature\n  // detect to determine the best RNG source, normalizing to a function that\n  // returns 128-bits of randomness, since that's what's usually required\n  var _rng, _mathRNG, _nodeRNG, _whatwgRNG, _previousRoot;\n\n  function setupBrowser() {\n    // Allow for MSIE11 msCrypto\n    var _crypto = _window.crypto || _window.msCrypto;\n\n    if (!_rng && _crypto && _crypto.getRandomValues) {\n      // WHATWG crypto-based RNG - http://wiki.whatwg.org/wiki/Crypto\n      //\n      // Moderately fast, high quality\n      try {\n        var _rnds8 = new Uint8Array(16);\n        _whatwgRNG = _rng = function whatwgRNG() {\n          _crypto.getRandomValues(_rnds8);\n          return _rnds8;\n        };\n        _rng();\n      } catch(e) {}\n    }\n\n    if (!_rng) {\n      // Math.random()-based (RNG)\n      //\n      // If all else fails, use Math.random().  It's fast, but is of unspecified\n      // quality.\n      var  _rnds = new Array(16);\n      _mathRNG = _rng = function() {\n        for (var i = 0, r; i < 16; i++) {\n          if ((i & 0x03) === 0) { r = Math.random() * 0x100000000; }\n          _rnds[i] = r >>> ((i & 0x03) << 3) & 0xff;\n        }\n\n        return _rnds;\n      };\n      if ('undefined' !== typeof console && console.warn) {\n        console.warn(\"[SECURITY] node-uuid: crypto not usable, falling back to insecure Math.random()\");\n      }\n    }\n  }\n\n  function setupNode() {\n    // Node.js crypto-based RNG - http://nodejs.org/docs/v0.6.2/api/crypto.html\n    //\n    // Moderately fast, high quality\n    if ('function' === typeof require) {\n      try {\n        var _rb = require('crypto').randomBytes;\n        _nodeRNG = _rng = _rb && function() {return _rb(16);};\n        _rng();\n      } catch(e) {}\n    }\n  }\n\n  if (_window) {\n    setupBrowser();\n  } else {\n    setupNode();\n  }\n\n  // Buffer class to use\n  var BufferClass = ('function' === typeof Buffer) ? Buffer : Array;\n\n  // Maps for number <-> hex string conversion\n  var _byteToHex = [];\n  var _hexToByte = {};\n  for (var i = 0; i < 256; i++) {\n    _byteToHex[i] = (i + 0x100).toString(16).substr(1);\n    _hexToByte[_byteToHex[i]] = i;\n  }\n\n  // **`parse()` - Parse a UUID into it's component bytes**\n  function parse(s, buf, offset) {\n    var i = (buf && offset) || 0, ii = 0;\n\n    buf = buf || [];\n    s.toLowerCase().replace(/[0-9a-f]{2}/g, function(oct) {\n      if (ii < 16) { // Don't overflow!\n        buf[i + ii++] = _hexToByte[oct];\n      }\n    });\n\n    // Zero out remaining bytes if string was short\n    while (ii < 16) {\n      buf[i + ii++] = 0;\n    }\n\n    return buf;\n  }\n\n  // **`unparse()` - Convert UUID byte array (ala parse()) into a string**\n  function unparse(buf, offset) {\n    var i = offset || 0, bth = _byteToHex;\n    return  bth[buf[i++]] + bth[buf[i++]] +\n            bth[buf[i++]] + bth[buf[i++]] + '-' +\n            bth[buf[i++]] + bth[buf[i++]] + '-' +\n            bth[buf[i++]] + bth[buf[i++]] + '-' +\n            bth[buf[i++]] + bth[buf[i++]] + '-' +\n            bth[buf[i++]] + bth[buf[i++]] +\n            bth[buf[i++]] + bth[buf[i++]] +\n            bth[buf[i++]] + bth[buf[i++]];\n  }\n\n  // **`v1()` - Generate time-based UUID**\n  //\n  // Inspired by https://github.com/LiosK/UUID.js\n  // and http://docs.python.org/library/uuid.html\n\n  // random #'s we need to init node and clockseq\n  var _seedBytes = _rng();\n\n  // Per 4.5, create and 48-bit node id, (47 random bits + multicast bit = 1)\n  var _nodeId = [\n    _seedBytes[0] | 0x01,\n    _seedBytes[1], _seedBytes[2], _seedBytes[3], _seedBytes[4], _seedBytes[5]\n  ];\n\n  // Per 4.2.2, randomize (14 bit) clockseq\n  var _clockseq = (_seedBytes[6] << 8 | _seedBytes[7]) & 0x3fff;\n\n  // Previous uuid creation time\n  var _lastMSecs = 0, _lastNSecs = 0;\n\n  // See https://github.com/broofa/node-uuid for API details\n  function v1(options, buf, offset) {\n    var i = buf && offset || 0;\n    var b = buf || [];\n\n    options = options || {};\n\n    var clockseq = (options.clockseq != null) ? options.clockseq : _clockseq;\n\n    // UUID timestamps are 100 nano-second units since the Gregorian epoch,\n    // (1582-10-15 00:00).  JSNumbers aren't precise enough for this, so\n    // time is handled internally as 'msecs' (integer milliseconds) and 'nsecs'\n    // (100-nanoseconds offset from msecs) since unix epoch, 1970-01-01 00:00.\n    var msecs = (options.msecs != null) ? options.msecs : new Date().getTime();\n\n    // Per 4.2.1.2, use count of uuid's generated during the current clock\n    // cycle to simulate higher resolution clock\n    var nsecs = (options.nsecs != null) ? options.nsecs : _lastNSecs + 1;\n\n    // Time since last uuid creation (in msecs)\n    var dt = (msecs - _lastMSecs) + (nsecs - _lastNSecs)/10000;\n\n    // Per 4.2.1.2, Bump clockseq on clock regression\n    if (dt < 0 && options.clockseq == null) {\n      clockseq = clockseq + 1 & 0x3fff;\n    }\n\n    // Reset nsecs if clock regresses (new clockseq) or we've moved onto a new\n    // time interval\n    if ((dt < 0 || msecs > _lastMSecs) && options.nsecs == null) {\n      nsecs = 0;\n    }\n\n    // Per 4.2.1.2 Throw error if too many uuids are requested\n    if (nsecs >= 10000) {\n      throw new Error('uuid.v1(): Can\\'t create more than 10M uuids/sec');\n    }\n\n    _lastMSecs = msecs;\n    _lastNSecs = nsecs;\n    _clockseq = clockseq;\n\n    // Per 4.1.4 - Convert from unix epoch to Gregorian epoch\n    msecs += 12219292800000;\n\n    // `time_low`\n    var tl = ((msecs & 0xfffffff) * 10000 + nsecs) % 0x100000000;\n    b[i++] = tl >>> 24 & 0xff;\n    b[i++] = tl >>> 16 & 0xff;\n    b[i++] = tl >>> 8 & 0xff;\n    b[i++] = tl & 0xff;\n\n    // `time_mid`\n    var tmh = (msecs / 0x100000000 * 10000) & 0xfffffff;\n    b[i++] = tmh >>> 8 & 0xff;\n    b[i++] = tmh & 0xff;\n\n    // `time_high_and_version`\n    b[i++] = tmh >>> 24 & 0xf | 0x10; // include version\n    b[i++] = tmh >>> 16 & 0xff;\n\n    // `clock_seq_hi_and_reserved` (Per 4.2.2 - include variant)\n    b[i++] = clockseq >>> 8 | 0x80;\n\n    // `clock_seq_low`\n    b[i++] = clockseq & 0xff;\n\n    // `node`\n    var node = options.node || _nodeId;\n    for (var n = 0; n < 6; n++) {\n      b[i + n] = node[n];\n    }\n\n    return buf ? buf : unparse(b);\n  }\n\n  // **`v4()` - Generate random UUID**\n\n  // See https://github.com/broofa/node-uuid for API details\n  function v4(options, buf, offset) {\n    // Deprecated - 'format' argument, as supported in v1.2\n    var i = buf && offset || 0;\n\n    if (typeof(options) === 'string') {\n      buf = (options === 'binary') ? new BufferClass(16) : null;\n      options = null;\n    }\n    options = options || {};\n\n    var rnds = options.random || (options.rng || _rng)();\n\n    // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n    rnds[6] = (rnds[6] & 0x0f) | 0x40;\n    rnds[8] = (rnds[8] & 0x3f) | 0x80;\n\n    // Copy bytes to buffer, if provided\n    if (buf) {\n      for (var ii = 0; ii < 16; ii++) {\n        buf[i + ii] = rnds[ii];\n      }\n    }\n\n    return buf || unparse(rnds);\n  }\n\n  // Export public API\n  var uuid = v4;\n  uuid.v1 = v1;\n  uuid.v4 = v4;\n  uuid.parse = parse;\n  uuid.unparse = unparse;\n  uuid.BufferClass = BufferClass;\n  uuid._rng = _rng;\n  uuid._mathRNG = _mathRNG;\n  uuid._nodeRNG = _nodeRNG;\n  uuid._whatwgRNG = _whatwgRNG;\n\n  if (('undefined' !== typeof module) && module.exports) {\n    // Publish as node.js module\n    module.exports = uuid;\n  } else if (typeof define === 'function' && define.amd) {\n    // Publish as AMD module\n    define(function() {return uuid;});\n\n\n  } else {\n    // Publish as global (in browsers)\n    _previousRoot = _window.uuid;\n\n    // **`noConflict()` - (browser only) to reset global 'uuid' var**\n    uuid.noConflict = function() {\n      _window.uuid = _previousRoot;\n      return uuid;\n    };\n\n    _window.uuid = uuid;\n  }\n})('undefined' !== typeof window ? window : null);\n","/* global localStorage, XMLHttpRequest */\nlet querystring = {};\nfunction strictUriEncode (str) {\n  return encodeURIComponent(str).replace(/[!'()*]/g, x => `%${x.charCodeAt(0).toString(16).toUpperCase()}`);\n}\nfunction encode (value, opts) {\n  if (opts.encode) {\n    return opts.strict ? strictUriEncode(value) : encodeURIComponent(value);\n  }\n  return value;\n}\nquerystring.stringify = (obj, opts) => {\n  if (!obj) {\n    return '';\n  }\n\n  const defaults = {\n    encode: true,\n    strict: true\n  };\n\n  opts = Object.assign({}, obj, defaults);\n\n  if (opts.sort === false) {\n    opts.sort = () => {};\n  }\n\n  const arrayFormatter = (key, value) => value === null ? encode(key, opts) : [\n    encode(key, opts),\n    '=',\n    encode(value, opts)\n  ].join('');\n\n  return Object.keys(obj).sort(opts.sort).map(key => {\n    const val = obj[key];\n\n    if (val === undefined) {\n      return '';\n    }\n\n    if (val === null) {\n      return encode(key, opts);\n    }\n\n    if (Array.isArray(val)) {\n      const result = [];\n\n      val.slice().forEach(val2 => {\n        if (val2 === undefined) {\n          return;\n        }\n\n        result.push(arrayFormatter(key, val2, result.length));\n      });\n\n      return result.join('&');\n    }\n\n    return `${encode(key, opts)}=${encode(val, opts)}`;\n  }).filter(x => {\n    return x.length > 0;\n  }).join('&');\n};\n\nconst post = (url, data = null) => {\n  if ('sendBeacon' in navigator) {\n    return navigator.sendBeacon(url, data);\n  }\n  let xhr = new XMLHttpRequest();\n  xhr.open('POST', url);\n  return xhr.send(data);\n};\n\nconst inDevMode = () => {\n  return window.isSecureContext === false || (window.location.protocol === 'http:' && window.location.port);\n};\n\nconst getWebGLCapabilities = () => {\n  try {\n    const canvas = document.createElement('canvas');\n    const gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');\n    /* eslint-disable no-undef */\n    return (gl && gl instanceof WebGLRenderingContext) || false;\n    /* eslint-enable no-undef */\n  } catch (err) {\n    return false;\n  }\n};\n\nconst getWebGL2Capabilities = () => {\n  try {\n    const canvas = document.createElement('canvas');\n    const gl = canvas.getContext('webgl2');\n    /* eslint-disable no-undef */\n    return (gl && gl instanceof WebGL2RenderingContext) || false;\n    /* eslint-enable no-undef */\n  } catch (err) {\n    return false;\n  }\n};\n\nconst getUserAgent = () => {\n  return navigator.userAgent;\n};\n\nconst getEndianness = () => {\n  if (!window.ArrayBuffer) {\n    return 'Unknown';\n  }\n  const buffer = new ArrayBuffer(4);\n  const intView = new Uint32Array(buffer);\n  const byteView = new Uint8Array(buffer);\n  intView[0] = 1;\n  return byteView[0] === 1 ? 'little' : 'big';\n};\n\nconst Reporter = ((() => {\n  class Reporter {\n    constructor (tagId = '') {\n      if (!tagId) {\n        throw new Error('`tagId` argument required for `Reporter` (e.g., `XXXXXX-YY`)');\n      }\n      this.tagId = tagId;\n    }\n\n    static setTagId (tagId = null) {\n      this.tagId = tagId;\n    }\n\n    static saveConsent (consented = true) {\n      if (!Reporter.consented()) {\n        return false;\n      }\n      localStorage.setItem('xrAgent.metrics.settings.consent', consented ? 'true' : 'false');\n      return true;\n    }\n\n    static removeConsent (consented = true) {\n      if (!Reporter.consented()) {\n        return false;\n      }\n      localStorage.removeItem('xrAgent.metrics.clientId');\n      localStorage.removeItem('xrAgent.metrics.name');\n      localStorage.removeItem('xrAgent.metrics.version');\n      localStorage.removeItem('xrAgent.metrics.settings.consent');\n      return true;\n    }\n\n    static consented () {\n      if (!Reporter.consented()) {\n        return false;\n      }\n      return localStorage.getItem('xrAgent.metrics.settings.consent') !== 'false';\n    }\n\n    static sendPageView (path, hostname, title, extraParams) {\n      const params = {\n        t: 'pageview',\n        path,\n        hostname,\n        title,\n        params: extraParams\n      };\n      return this.send(params);\n    }\n\n    static sendEvent (category, action, label, value) {\n      const params = {\n        t: 'event',\n        ec: category,\n        ea: action\n      };\n      if (label !== null) {\n        params.el = label;\n      }\n      if (value !== null) {\n        params.ev = value;\n      }\n      return this.send(params);\n    }\n\n    static sendTiming (category, name, value) {\n      const params = {\n        t: 'timing',\n        utc: category,\n        utv: name,\n        utt: value\n      };\n      return this.send(params);\n    }\n\n    static sendException (description) {\n      const params = {\n        t: 'exception',\n        exd: description,\n        exf: inDevMode() ? '0' : '1'\n      };\n      return this.send(params);\n    }\n\n    static sendCommand (commandName) {\n      let base;\n      let params;\n      if (this.commandCount === null) {\n        this.commandCount = {};\n      }\n      if ((base = this.commandCount)[commandName] === null) {\n        base[commandName] = 0;\n      }\n      this.commandCount[commandName]++;\n      params = {\n        t: 'event',\n        ec: 'command',\n        ea: commandName.split(':')[0],\n        el: commandName,\n        ev: this.commandCount[commandName]\n      };\n      return this.send(params);\n    }\n\n    static send (params) {\n      if (!Reporter.consented()) {\n        return;\n      }\n\n      this.tagId = params.tagId || this.tagId || localStorage.getItem('xrAgent.metrics.tagId');\n      this.clientId = this.clientId || localStorage.getItem('xrAgent.metrics.clientId');\n\n      this.dp = params.dp || params.uri || this.uri;\n      this.p = params.p || this.p || this.dp;\n\n      this.dh = params.host || params.dh || this.host;\n      this.dt = params.title || params.dt || this.title;\n      this.dr = params.referrer || params.dr || this.dr;\n      this.uip = params.remoteAddr || params.uip || this.uip;\n\n      this.xrAgentName = this.xrAgentName || localStorage.getItem('xrAgent.metrics.name');\n      this.xrAgentVersion = this.xrAgentVersion || localStorage.getItem('xrAgent.metrics.version');\n\n      if (!navigator.onLine) {\n        return;\n      }\n\n      params = Object.assign({}, params, {\n        v: 1,\n        aip: 1,\n        tid: this.tagId,\n        // cd: this.screenName,  // TODO: Add Screen Name.\n        cid: this.clientId,\n        dp: this.uri,\n        dh: this.dh,\n        dt: this.dt,\n        dr: this.dr,\n        p: this.p,\n        uip: this.remoteAddr,\n        an: this.xrAgentName,  // App Name.\n        av: this.xrAgentVersion,  // App Version.\n        aiid: ''  // TODO: Add App Installer ID.\n      });\n      params = Object.assign({}, params, Reporter.consentedParams());\n      if (Reporter.isTelemetryConsentChoice(params)) {\n        return Reporter.request(`https://ssl.google-analytics.com/collect?${querystring.stringify(params)}`);\n      }\n    }\n\n    static isTelemetryConsentChoice (params) {\n      return params.t === 'event' && params.ec === 'setting' && params.ea === 'xrAgent.metrics.settings.consent';\n    }\n\n    static request (url) {\n      return post(url);\n    }\n\n    static consentedParams () {\n      return {\n        sr: `${window.screen.width}x${window.screen.height}`,\n        vp: `${window.innerWidth}x${window.innerHeight}`,\n        dpr: window.devicePixelRatio || 1,\n        capvr: !!navigator.getVRDisplays,\n        capxr: !!navigator.xr,\n        capgp: !!window.Gamepad,\n        capaudio: (!!window.AudioContext || !!window.webkitAudioContext),\n        capwasm: !!window.WebAssembly,\n        capric: !!window.requestIdleCallback,\n        capwebgl: getWebGLCapabilities(),\n        capwebgl2: getWebGL2Capabilities(),\n        capworker: !!window.Worker,\n        capsw: !!navigator.serviceWorker,\n        caphc: navigator.hardwareConcurrency || 0,\n        capws: !!window.WebSocket || false,\n        capwebrtc: (!!window.RTCPeerConnection && !!window.RTCDataChannelEvent) || false,\n        capendian: getEndianness(),\n        ua: getUserAgent()\n      };\n    }\n  }\n\n  return Reporter;\n}))();\n\nexport default Reporter;\n","/* global localStorage, location */\nimport * as uuid from 'node-uuid';\n\nimport Reporter from './reporter.js';\n\nconst PathRE = /'?((\\/|\\\\|[a-z]:\\\\)[^\\s']+)+'?/ig;\nconst stripPath = msg => msg.replace(PathRE, '<path>');\n\nclass Metrics {\n  static constructor (tagId, clientId) {\n    this.tagId = tagId;\n    this.clientId = clientId;\n  }\n\n  static activate (arg) {\n    if (!Reporter.consented()) {\n      return false;\n    }\n    this.subscriptions = [];\n    let sessionLength = arg.sessionLength;\n    return this.ensureClientId(((_this => () => _this.begin(sessionLength)))(this));\n  }\n\n  deactivate () {\n    delete this.subscriptions;\n    this.subscriptions = [];\n  }\n\n  serialize () {\n    return {\n      sessionLength: Date.now() - this.sessionStart\n    };\n  }\n\n  provideReporter () {\n    return {\n      sendEvent: Reporter.sendEvent.bind(Reporter),\n      sendTiming: Reporter.sendTiming.bind(Reporter),\n      sendException: Reporter.sendException.bind(Reporter)\n    };\n  }\n\n  begin (sessionLength) {\n    this.sessionStart = Date.now();\n    if (sessionLength) {\n      Reporter.sendEvent('window', 'ended', null, sessionLength);\n    }\n    Reporter.sendEvent('window', 'started');\n    this.watchExceptions();\n    this.watchPageView();\n    this.watchEvents();\n    this.watchPerfTimings();\n  }\n\n  ensureClientId (callback) {\n    if (localStorage.getItem('xrAgent.metrics.clientId')) {\n      return callback();\n    }\n    return this.createClientId(clientId => {\n      localStorage.setItem('xrAgent.metrics.clientId', clientId);\n      return callback();\n    });\n  }\n\n  createClientId (callback) {\n    if (this.clientId) {\n      return callback(this.clientId);\n    }\n    return callback(uuid.v4);\n  }\n\n  getClientId () {\n    return localStorage.getItem('xrAgent.metrics.clientId');\n  }\n\n  getTagId () {\n    if (this.tagId) {\n      return this.tagId;\n    }\n    this.tagId = localStorage.getItem('xrAgent.metrics.tagId');\n    return this.tagId;\n  }\n\n  setTagId (tagId) {\n    this.tagId = localStorage.setItem('xrAgent.metrics.tagId', tagId);\n    return tagId;\n  }\n\n  watchExceptions () {\n    return this.subscriptions.push(() => {\n      window.addEventListener('error', event => {\n        let errorMessage = event;\n        if (typeof event !== 'string') {\n          errorMessage = event.message;\n        }\n        errorMessage = (stripPath(errorMessage) || 'Unknown').replace('Uncaught ', '').slice(0, 150);\n        return Reporter.sendException(errorMessage);\n      });\n    });\n  }\n\n  watchPageView () {\n    return this.subscriptions.push(() => {\n      Reporter.sendPageView(location.pathname, location.href, document.title);\n    });\n  }\n\n  watchEvents () {\n    return this.subscriptions.push(() => {\n      // TODO: Call `Reporter.sendCommand(event.type)` for each whitelisted event (e.g., `vrdisplay*` in WebVR v1.1).\n      // READ:\n      //   - https://github.com/cvan/webxr-agent/blob/fe94ff57a0a2a90fe1d48cb7b3dba5a1105909db/public/telemetry.js#L129-L159\n    });\n  }\n\n  watchTimings () {\n    return this.subscriptions.push(() => {\n      // TODO: Measure load times for `LoaderParsing`, `LoaderParsingStart`, `LoadingStart`.\n      // READ:\n      //   - https://github.com/mozilla/unity-webvr-export/pull/189/files\n      //     - https://github.com/delapuente/unity-webvr-export/blob/fd5b1fb9/Assets/WebGLTemplates/WebVR/index.html#L14-L29\n      //     - https://github.com/delapuente/unity-webvr-export/blob/fd5b1fb9/Assets/WebGLTemplates/WebVR/webvr.js#L40\n    });\n  }\n}\n\nconst tagId = getTag();\nconst metrics = new Metrics(tagId);\nmetrics.activate();\n\nfunction getTag (scriptUrl) {\n  if (document.currentScript) {\n    return document.currentScript.getAttribute('data-tag');\n  }\n  scriptUrl = scriptUrl || document.scriptURL || (document.currentScript && document.currentScript.src);\n  if (!scriptUrl) {\n    return null;\n  }\n  try {\n    return new window.URLSearchParams(new window.URL(scriptUrl).search).get('tag');\n  } catch (err) {\n    return (scriptUrl.match(/[?&]tag=(.+)/i) || [])[1];\n  }\n}\n\nexport default metrics;\n"],"names":["_window","_rng","_mathRNG","_nodeRNG","_whatwgRNG","_previousRoot","_crypto","crypto","msCrypto","getRandomValues","_rnds8","Uint8Array","e","_rnds","Array","r","i","Math","random","console","warn","setupBrowser","_rb","require$$0","randomBytes","setupNode","BufferClass","Buffer","_byteToHex","_hexToByte","toString","substr","unparse","buf","offset","_seedBytes","_nodeId","_clockseq","_lastMSecs","_lastNSecs","v4","options","rnds","rng","ii","uuid","v1","b","clockseq","msecs","Date","getTime","nsecs","dt","Error","tl","tmh","node","n","parse","s","toLowerCase","replace","oct","module","exports","noConflict","window","querystring","encode","value","opts","strict","encodeURIComponent","x","charCodeAt","toUpperCase","stringify","obj","Object","assign","sort","keys","map","key","const","val","undefined","isArray","result","slice","forEach","val2","push","join","arrayFormatter","filter","length","Reporter","tagId","setTagId","saveConsent","consented","setItem","removeConsent","removeItem","localStorage","getItem","sendPageView","path","hostname","title","extraParams","this","send","sendEvent","category","action","label","params","el","ev","sendTiming","name","sendException","description","isSecureContext","location","protocol","port","sendCommand","commandName","base","commandCount","split","clientId","dp","uri","p","dh","host","dr","referrer","uip","remoteAddr","xrAgentName","xrAgentVersion","navigator","onLine","consentedParams","isTelemetryConsentChoice","request","t","ec","ea","url","data","sendBeacon","let","xhr","XMLHttpRequest","open","post","screen","devicePixelRatio","getVRDisplays","xr","Gamepad","AudioContext","webkitAudioContext","WebAssembly","requestIdleCallback","canvas","document","createElement","gl","getContext","WebGLRenderingContext","err","getWebGLCapabilities","WebGL2RenderingContext","getWebGL2Capabilities","Worker","serviceWorker","hardwareConcurrency","WebSocket","RTCPeerConnection","RTCDataChannelEvent","ArrayBuffer","buffer","intView","Uint32Array","byteView","getEndianness","userAgent","PathRE","Metrics","constructor","activate","arg","subscriptions","_this","sessionLength","ensureClientId","begin","deactivate","serialize","now","sessionStart","provideReporter","bind","watchExceptions","watchPageView","watchEvents","watchPerfTimings","callback","createClientId","uuid.v4","getClientId","getTagId","addEventListener","event","msg","errorMessage","message","pathname","href","watchTimings","metrics","scriptUrl","currentScript","getAttribute","scriptURL","src","URLSearchParams","URL","search","get","match","getTag"],"mappings":"sIAMA,SAAUA,GACR,IAKIC,EAAMC,EAAUC,EAAUC,EAAYC,EAqDtCL,EAnDJ,WAEE,IAAIM,EAAUN,EAAQO,QAAUP,EAAQQ,SAExC,IAAKP,GAAQK,GAAWA,EAAQG,gBAI9B,IACE,IAAIC,EAAS,IAAIC,WAAW,IAC5BP,EAAaH,EAAO,WAElB,OADAK,EAAQG,gBAAgBC,GACjBA,GAETT,IACA,MAAMW,IAGV,IAAKX,EAAM,CAKT,IAAKY,EAAQ,IAAIC,MAAM,IACvBZ,EAAWD,EAAO,WAChB,IAAK,IAAWc,EAAPC,EAAI,EAAMA,EAAI,GAAIA,IACN,IAAV,EAAJA,KAAmBD,EAAoB,WAAhBE,KAAKC,UACjCL,EAAMG,GAAKD,MAAY,EAAJC,IAAa,GAAK,IAGvC,OAAOH,GAEL,oBAAuBM,SAAWA,QAAQC,MAC5CD,QAAQC,KAAK,oFAmBjBC,GAdF,WAKI,IACE,IAAIC,EAAMC,EAAkBC,YAC5BrB,EAAWF,EAAOqB,GAAO,WAAY,OAAOA,EAAI,KAChDrB,IACA,MAAMW,KAOVa,GASF,IALA,IAAIC,EAAe,mBAAsBC,OAAUA,OAASb,MAGxDc,KACAC,KACKb,EAAI,EAAGA,EAAI,IAAKA,IACvBY,EAAWZ,IAAMA,EAAI,KAAOc,SAAS,IAAIC,OAAO,GAChDF,EAAWD,EAAWZ,IAAMA,EAuB9B,SAASgB,EAAQC,EAAKC,GACpB,IAAIlB,EAAIkB,GAAU,EAClB,OAD2BN,EACfK,EAAIjB,MADWY,EACCK,EAAIjB,MADLY,EAEfK,EAAIjB,MAFWY,EAECK,EAAIjB,MAAQ,IAFbY,EAGfK,EAAIjB,MAHWY,EAGCK,EAAIjB,MAAQ,IAHbY,EAIfK,EAAIjB,MAJWY,EAICK,EAAIjB,MAAQ,IAJbY,EAKfK,EAAIjB,MALWY,EAKCK,EAAIjB,MAAQ,IALbY,EAMfK,EAAIjB,MANWY,EAMCK,EAAIjB,MANLY,EAOfK,EAAIjB,MAPWY,EAOCK,EAAIjB,MAPLY,EAQfK,EAAIjB,MARWY,EAQCK,EAAIjB,MASlC,IAAImB,EAAalC,IAGbmC,GACc,EAAhBD,EAAW,GACXA,EAAW,GAAIA,EAAW,GAAIA,EAAW,GAAIA,EAAW,GAAIA,EAAW,IAIrEE,EAAmD,OAAtCF,EAAW,IAAM,EAAIA,EAAW,IAG7CG,EAAa,EAAGC,EAAa,EAiFjC,SAASC,EAAGC,EAASR,EAAKC,GAExB,IAAIlB,EAAIiB,GAAOC,GAAU,EAED,qBACtBD,EAAmB,WAAZQ,EAAwB,IAAIf,EAAY,IAAM,KACrDe,EAAU,MAIZ,IAAIC,GAFJD,EAAUA,OAESvB,SAAWuB,EAAQE,KAAO1C,KAO7C,GAJAyC,EAAK,GAAgB,GAAVA,EAAK,GAAa,GAC7BA,EAAK,GAAgB,GAAVA,EAAK,GAAa,IAGzBT,EACF,IAAK,IAAIW,EAAK,EAAGA,EAAK,GAAIA,IACxBX,EAAIjB,EAAI4B,GAAMF,EAAKE,GAIvB,OAAOX,GAAOD,EAAQU,GAIxB,IAAIG,EAAOL,EACXK,EAAKC,GA1GL,SAAYL,EAASR,EAAKC,GACxB,IAAIlB,EAAIiB,GAAOC,GAAU,EACrBa,EAAId,MAIJe,EAAgC,OAFpCP,EAAUA,OAEcO,SAAoBP,EAAQO,SAAWX,EAM3DY,EAA0B,MAAjBR,EAAQQ,MAAiBR,EAAQQ,OAAQ,IAAIC,MAAOC,UAI7DC,EAA0B,MAAjBX,EAAQW,MAAiBX,EAAQW,MAAQb,EAAa,EAG/Dc,EAAMJ,EAAQX,GAAec,EAAQb,GAAY,IAcrD,GAXIc,EAAK,GAAyB,MAApBZ,EAAQO,WACpBA,EAAWA,EAAW,EAAI,QAKvBK,EAAK,GAAKJ,EAAQX,IAAgC,MAAjBG,EAAQW,QAC5CA,EAAQ,GAINA,GAAS,IACX,MAAM,IAAIE,MAAM,mDAGlBhB,EAAaW,EACbV,EAAaa,EACbf,EAAYW,EAMZ,IAAIO,GAA4B,KAAb,WAHnBN,GAAS,cAG+BG,GAAS,WACjDL,EAAE/B,KAAOuC,IAAO,GAAK,IACrBR,EAAE/B,KAAOuC,IAAO,GAAK,IACrBR,EAAE/B,KAAOuC,IAAO,EAAI,IACpBR,EAAE/B,KAAY,IAALuC,EAGT,IAAIC,EAAOP,EAAQ,WAAc,IAAS,UAC1CF,EAAE/B,KAAOwC,IAAQ,EAAI,IACrBT,EAAE/B,KAAa,IAANwC,EAGTT,EAAE/B,KAAOwC,IAAQ,GAAK,GAAM,GAC5BT,EAAE/B,KAAOwC,IAAQ,GAAK,IAGtBT,EAAE/B,KAAOgC,IAAa,EAAI,IAG1BD,EAAE/B,KAAkB,IAAXgC,EAIT,IADA,IAAIS,EAAOhB,EAAQgB,MAAQrB,EAClBsB,EAAI,EAAGA,EAAI,EAAGA,IACrBX,EAAE/B,EAAI0C,GAAKD,EAAKC,GAGlB,OAAOzB,GAAYD,EAAQe,IAmC7BF,EAAKL,GAAKA,EACVK,EAAKc,MAhKL,SAAeC,EAAG3B,EAAKC,GACrB,IAAIlB,EAAKiB,GAAOC,GAAW,EAAGU,EAAK,EAUnC,IARAX,EAAMA,MACN2B,EAAEC,cAAcC,QAAQ,eAAgB,SAASC,GAC3CnB,EAAK,KACPX,EAAIjB,EAAI4B,KAAQf,EAAWkC,MAKxBnB,EAAK,IACVX,EAAIjB,EAAI4B,KAAQ,EAGlB,OAAOX,GAkJTY,EAAKb,QAAUA,EACfa,EAAKnB,YAAcA,EACnBmB,EAAK5C,KAAOA,EACZ4C,EAAK3C,SAAWA,EAChB2C,EAAK1C,SAAWA,EAChB0C,EAAKzC,WAAaA,EAEqB4D,EAAOC,QAE5CD,UAAiBnB,GAQjBxC,EAAgBL,EAAQ6C,KAGxBA,EAAKqB,WAAa,WAEhB,OADAlE,EAAQ6C,KAAOxC,EACRwC,GAGT7C,EAAQ6C,KAAOA,GAvQnB,CAyQG,oBAAuBsB,OAASA,OAAS,YC9QxCC,KAIJ,SAASC,EAAQC,EAAOC,GACtB,OAAIA,EAAKF,OACAE,EAAKC,OAJPC,mBAIgCH,GAJRR,QAAQ,oBAAYY,aAASA,EAAEC,WAAW,GAAG7C,SAAS,IAAI8C,gBAIzCH,mBAAmBH,GAE5DA,EAETF,EAAYS,mBAAaC,EAAKP,GAC5B,IAAKO,EACH,MAAO,IAUS,KAFlBP,EAAOQ,OAAOC,UAAWF,GAJvBT,QAAQ,EACRG,QAAQ,KAKDS,OACPV,EAAKU,mBASP,OAAOF,OAAOG,KAAKJ,GAAKG,KAAKV,EAAKU,MAAME,aAAIC,GAC1CC,IAAMC,EAAMR,EAAIM,GAEhB,QAAYG,IAARD,EACF,MAAO,GAGT,GAAY,OAARA,EACF,OAAOjB,EAAOe,EAAKb,GAGrB,GAAIzD,MAAM0E,QAAQF,GAAM,CACtBD,IAAMI,KAUN,OARAH,EAAII,QAAQC,iBAAQC,QACLL,IAATK,GAIJH,EAAOI,cAzBWT,EAAKd,UAAoB,OAAVA,EAAiBD,EAAOe,EAAKb,IAClEF,EAAOe,EAAKb,GACZ,IACAF,EAAOC,EAAOC,IACduB,KAAK,IAqBWC,CAAeX,EAAKQ,MAG3BH,EAAOK,KAAK,KAGrB,OAAUzB,EAAOe,EAAKb,OAASF,EAAOiB,EAAKf,KAC1CyB,gBAAOtB,UACDA,EAAEuB,OAAS,IACjBH,KAAK,MAGVT,IAoDMa,aACJ,IAAMA,EACJ,SAAaC,qBAAQ,KACdA,QACG,IAAI7C,MAAM,qEAEb6C,MAAQA,GA+KjB,SA5KSC,kBAAUD,kBAAQ,WAClBA,MAAQA,KAGRE,qBAAaC,0BAAY,KACzBJ,EAASI,2BAGDC,QAAQ,mCAAoCD,EAAY,OAAS,UACvE,MAGFE,uBAAeF,0BAAY,KAC3BJ,EAASI,2BAGDG,WAAW,yCACXA,WAAW,qCACXA,WAAW,wCACXA,WAAW,qCACjB,MAGFH,6BACAJ,EAASI,aAGsD,UAA7DI,aAAaC,QAAQ,uCAGvBC,sBAAcC,EAAMC,EAAUC,EAAOC,UAQnCC,KAAKC,QANP,gBACHL,WACAC,QACAC,SACQC,OAKLG,mBAAWC,EAAUC,EAAQC,EAAOhD,OACnCiD,KACD,WACCH,KACAC,UAEQ,OAAVC,MACKE,GAAKF,GAEA,OAAVhD,MACKmD,GAAKnD,GAEP2C,KAAKC,KAAKK,MAGZG,oBAAYN,EAAUO,EAAMrD,UAO1B2C,KAAKC,QALP,aACEE,MACAO,MACArD,OAKFsD,uBAAeC,OACdN,KACD,gBACEM,OAxHuB,IAA3B1D,OAAO2D,iBAA2D,UAA7B3D,OAAO4D,SAASC,UAAwB7D,OAAO4D,SAASE,KAyH3E,IAAM,YAEpBhB,KAAKC,KAAKK,MAGZW,qBAAaC,OACdC,EACAb,SACsB,OAAtBN,KAAKoB,oBACFA,iBAEyC,QAA3CD,EAAOnB,KAAKoB,cAAcF,OACxBA,GAAe,QAEjBE,aAAaF,UAEb,WACC,aACAA,EAAYG,MAAM,KAAK,MACvBH,KACAlB,KAAKoB,aAAaF,IAEjBlB,KAAKC,KAAKK,MAGZL,cAAMK,MACNrB,EAASI,mBAITH,MAAQoB,EAAOpB,OAASc,KAAKd,OAASO,aAAaC,QAAQ,8BAC3D4B,SAAWtB,KAAKsB,UAAY7B,aAAaC,QAAQ,iCAEjD6B,GAAKjB,EAAOiB,IAAMjB,EAAOkB,KAAOxB,KAAKwB,SACrCC,EAAInB,EAAOmB,GAAKzB,KAAKyB,GAAKzB,KAAKuB,QAE/BG,GAAKpB,EAAOqB,MAAQrB,EAAOoB,IAAM1B,KAAK2B,UACtCvF,GAAKkE,EAAOR,OAASQ,EAAOlE,IAAM4D,KAAKF,WACvC8B,GAAKtB,EAAOuB,UAAYvB,EAAOsB,IAAM5B,KAAK4B,QAC1CE,IAAMxB,EAAOyB,YAAczB,EAAOwB,KAAO9B,KAAK8B,SAE9CE,YAAchC,KAAKgC,aAAevC,aAAaC,QAAQ,6BACvDuC,eAAiBjC,KAAKiC,gBAAkBxC,aAAaC,QAAQ,2BAE7DwC,UAAUC,iBAINrE,OAAOC,UAAWuC,KACtB,MACE,MACAN,KAAKd,UAELc,KAAKsB,YACNtB,KAAKwB,OACLxB,KAAK0B,MACL1B,KAAK5D,MACL4D,KAAK4B,KACN5B,KAAKyB,MACHzB,KAAK+B,cACN/B,KAAKgC,eACLhC,KAAKiC,oBACH,OAECnE,OAAOC,UAAWuC,EAAQrB,EAASmD,mBACxCnD,EAASoD,yBAAyB/B,GAC7BrB,EAASqD,oDAAoDnF,EAAYS,UAAU0C,cAIvF+B,kCAA0B/B,SACX,UAAbA,EAAOiC,GAA+B,YAAdjC,EAAOkC,IAAkC,qCAAdlC,EAAOmC,MAG5DH,iBAASI,mBA7MNA,EAAKC,GACjB,kBADwB,MACpB,eAAgBT,UAClB,OAAOA,UAAUU,WAAWF,EAAKC,GAEnCE,IAAIC,EAAM,IAAIC,eAEd,OADAD,EAAIE,KAAK,OAAQN,GACVI,EAAI7C,KAAK0C,GAwMLM,CAAKP,MAGPN,qCAEIlF,OAAOgG,iBAAgBhG,OAAOgG,iBAC9BhG,sBAAqBA,uBACvBA,OAAOiG,kBAAoB,UACvBjB,UAAUkB,sBACVlB,UAAUmB,WACVnG,OAAOoG,mBACHpG,OAAOqG,gBAAkBrG,OAAOsG,6BAClCtG,OAAOuG,qBACRvG,OAAOwG,wCA7MvB,IACEtF,IAAMuF,EAASC,SAASC,cAAc,UAChCC,EAAKH,EAAOI,WAAW,UAAYJ,EAAOI,WAAW,sBAE3D,OAAQD,GAAMA,aAAcE,wBAA0B,QAE/CC,GACP,OAAO,GAuMOC,wBAlMhB,IACE9F,IACM0F,EADSF,SAASC,cAAc,UACpBE,WAAW,UAE7B,OAAQD,GAAMA,aAAcK,yBAA2B,QAEhDF,GACP,OAAO,GA4LQG,eACElH,OAAOmH,eACXnC,UAAUoC,oBACZpC,UAAUqC,qBAAuB,UAC/BrH,OAAOsH,YAAa,cACftH,OAAOuH,qBAAuBvH,OAAOwH,sBAAwB,uBAxLjF,IAAKxH,OAAOyH,YACV,MAAO,UAETvG,IAAMwG,EAAS,IAAID,YAAY,GACzBE,EAAU,IAAIC,YAAYF,GAC1BG,EAAW,IAAIrL,WAAWkL,GAEhC,OADAC,EAAQ,GAAK,EACU,IAAhBE,EAAS,GAAW,SAAW,MAkLrBC,MA7LV9C,UAAU+C,YAmMVhG,KCpSHiG,EAAS,mCAGTC,iBACGC,qBAAalG,EAAOoC,QACpBpC,MAAQA,OACRoC,SAAWA,KAGX+D,kBAAUC,OACVrG,EAASI,mBACL,OAEJkG,qBAEwBC,EADzBC,EAAgBH,EAAIG,qBACjBzF,KAAK0F,gBAAiBF,EAA4CxF,uBAA7BwF,EAAMG,MAAMF,mBAG1DG,6BACS5F,KAAKuF,mBACPA,8BAGPM,0CAEmB5J,KAAK6J,MAAQ9F,KAAK+F,2BAIrCC,4CAEe/G,EAASiB,UAAU+F,KAAKhH,cACvBA,EAASwB,WAAWwF,KAAKhH,iBACtBA,EAAS0B,cAAcsF,KAAKhH,iBAI/C0G,eAAOF,QACAM,aAAe9J,KAAK6J,MACrBL,KACOvF,UAAU,SAAU,QAAS,KAAMuF,KAErCvF,UAAU,SAAU,gBACxBgG,uBACAC,qBACAC,mBACAC,gCAGPX,wBAAgBY,UACV7G,aAAaC,QAAQ,4BAChB4G,IAEFtG,KAAKuG,wBAAejF,uBACZhC,QAAQ,2BAA4BgC,GAC1CgF,mBAIXC,wBAAgBD,UAELA,EADLtG,KAAKsB,SACStB,KAAKsB,cAEPkF,gBAGlBC,8BACShH,aAAaC,QAAQ,yCAG9BgH,2BACM1G,KAAKd,MACAc,KAAKd,YAETA,MAAQO,aAAaC,QAAQ,yBAC3BM,KAAKd,oBAGdC,kBAAUD,eACHA,MAAQO,aAAaH,QAAQ,wBAAyBJ,GACpDA,eAGTgH,kCACSlG,KAAKuF,cAAc3G,uBACjB+H,iBAAiB,iBAASC,OApFrBC,EAqFNC,EAAeF,QACE,iBAAVA,MACMA,EAAMG,YAvFbF,EAyFgBC,EAzFTD,EAAIhK,QAAQqI,EAAQ,WAyFM,WAAWrI,QAAQ,YAAa,IAAI4B,MAAM,EAAG,KACjFQ,EAAS0B,cAAcmG,oBAKpCX,gCACSnG,KAAKuF,cAAc3G,kBACfe,aAAamB,SAASkG,SAAUlG,SAASmG,KAAMrD,SAAS9D,sBAIrEsG,8BACSpG,KAAKuF,cAAc3G,gCAO5BsI,+BACSlH,KAAKuF,cAAc3G,oBAU9BR,IACM+I,EAAU,IAAIhC,EAGpB,SAAiBiC,GACf,GAAIxD,SAASyD,cACX,OAAOzD,SAASyD,cAAcC,aAAa,YAG7C,KADAF,EAAYA,GAAaxD,SAAS2D,WAAc3D,SAASyD,eAAiBzD,SAASyD,cAAcG,KAE/F,OAAO,KAET,IACE,OAAO,IAAItK,OAAOuK,gBAAgB,IAAIvK,OAAOwK,IAAIN,GAAWO,QAAQC,IAAI,aACjE3D,GACP,OAAQmD,EAAUS,MAAM,sBAAwB,IAftCC,IAEdX,EAAQ9B"}