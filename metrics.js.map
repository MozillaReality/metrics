{"version":3,"file":"metrics.js","sources":["src/lib/storage.js","src/lib/reporter.js","src/lib/metrics.js"],"sourcesContent":["class LS {\n  constructor (win = window, prefix = '') {\n    try {\n      this.storage = win.localStorage;\n    } catch (err) {\n      this.storage = {};\n    }\n    this.prefix = prefix || '';\n  }\n\n  get (key) {\n    try {\n      return this.storage[this.prefix + key];\n    } catch (err) {\n      return null;\n    }\n  }\n\n  set (key, value) {\n    try {\n      this.storage[this.prefix + key] = value;\n      return value;\n    } catch (err) {\n      return null;\n    }\n  }\n\n  delete (key) {\n    try {\n      delete this.storage[this.prefix + key];\n    } catch (err) {\n      return null;\n    }\n  }\n\n  clear (key) {\n    try {\n      delete this.storage;\n    } catch (err) {\n      return null;\n    }\n  }\n}\n\nexport default LS;\n","/* global XMLHttpRequest */\nimport LS from './storage.js';\n\nimport Utils from './utils.js';\n\nconst post = (url, data = null) => {\n  if ('sendBeacon' in navigator) {\n    return navigator.sendBeacon(url, data);\n  }\n  let xhr = new XMLHttpRequest();\n  xhr.open('POST', url);\n  return xhr.send(data);\n};\n\nconst inDevMode = (win) => {\n  return win.isSecureContext === false || (win.location.protocol === 'http:' && win.location.port);\n};\n\nconst getDevicePixelRatio = (win) => {\n  return win.devicePixelRatio || 1;\n};\n\nconst getWebGLCapabilities = (win, doc) => {\n  try {\n    const canvas = doc.createElement('canvas');\n    const gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');\n    /* eslint-disable no-undef */\n    return (gl && gl instanceof win.WebGLRenderingContext) || false;\n    /* eslint-enable no-undef */\n  } catch (err) {\n    return false;\n  }\n};\n\nconst getWebGL2Capabilities = (win, doc) => {\n  try {\n    const canvas = doc.createElement('canvas');\n    const gl = canvas.getContext('webgl2');\n    /* eslint-disable no-undef */\n    return (gl && gl instanceof win.WebGL2RenderingContext) || false;\n    /* eslint-enable no-undef */\n  } catch (err) {\n    return false;\n  }\n};\n\nconst getUserAgent = (win) => {\n  return win.navigator.userAgent;\n};\n\nconst getEndianness = (win) => {\n  if (!win.ArrayBuffer) {\n    return 'Unknown';\n  }\n  const buffer = new win.ArrayBuffer(4);\n  const intView = new win.Uint32Array(buffer);\n  const byteView = new win.Uint8Array(buffer);\n  intView[0] = 1;\n  return byteView[0] === 1 ? 'little' : 'big';\n};\n\nclass Reporter {\n  constructor (tagId = '', storage, win = window, doc = document) {\n    if (!tagId) {\n      throw new Error('`tagId` argument required for `Reporter` (e.g., `XXXXXX-YY`)');\n    }\n    this.tagId = tagId;\n    this.win = win || window;\n    this.doc = doc || document;\n    this.storage = storage || new LS(this.win, 'xrAgent.metrics.');\n    this.consented = this.hasConsented();\n  }\n\n  setTagId (tagId = null) {\n    this.tagId = tagId;\n  }\n\n  saveConsent (consented = true) {\n    if (this.hasConsented()) {\n      return false;\n    }\n    this.storage.set('settings.consent', consented ? 'true' : 'false');\n    return true;\n  }\n\n  removeConsent (consented = true) {\n    if (!this.hasConsented()) {\n      return false;\n    }\n    this.storage.remove('clientId');\n    this.storage.remove('name');\n    this.storage.remove('version');\n    this.storage.remove('settings.consent');\n    return true;\n  }\n\n  hasConsented () {\n    if (this.consented === true) {\n      return true;\n    }\n    return this.storage.get('settings.consent') !== 'false';\n  }\n\n  sendPageView (path, hostname, title, extraParams) {\n    const params = {\n      t: 'pageview',\n      path,\n      hostname,\n      title,\n      params: extraParams\n    };\n    return this.send(params);\n  }\n\n  sendEvent (category, action, label, value) {\n    const params = {\n      t: 'event',\n      ec: category,\n      ea: action\n    };\n    if (label !== null) {\n      params.el = label;\n    }\n    if (value !== null) {\n      params.ev = value;\n    }\n    return this.send(params);\n  }\n\n  sendTiming (category, name, value) {\n    const params = {\n      t: 'timing',\n      utc: category,\n      utv: name,\n      utt: value\n    };\n    return this.send(params);\n  }\n\n  sendException (description) {\n    const params = {\n      t: 'exception',\n      exd: description,\n      exf: inDevMode(this.win) ? '0' : '1'\n    };\n    return this.send(params);\n  }\n\n  sendCommand (commandName) {\n    let base;\n    let params;\n    if (this.commandCount === null) {\n      this.commandCount = {};\n    }\n    if ((base = this.commandCount)[commandName] === null) {\n      base[commandName] = 0;\n    }\n    this.commandCount[commandName]++;\n    params = {\n      t: 'event',\n      ec: 'command',\n      ea: commandName.split(':')[0],\n      el: commandName,\n      ev: this.commandCount[commandName]\n    };\n    return this.send(params);\n  }\n\n  send (params) {\n    if (!this.hasConsented()) {\n      return;\n    }\n\n    this.tagId = params.tagId || this.tagId || this.storage.get('tagId');\n    this.clientId = this.clientId || this.storage.get('clientId');\n\n    this.dp = params.dp || params.uri || this.uri;\n    this.p = params.p || this.p || this.dp;\n\n    this.dh = params.host || params.dh || this.host;\n    this.dt = params.title || params.dt || this.title;\n    this.dr = params.referrer || params.dr || this.dr;\n    this.uip = params.remoteAddr || params.uip || this.uip;\n\n    this.xrAgentName = this.xrAgentName || this.storage.get('name');\n    this.xrAgentVersion = this.xrAgentVersion || this.storage.get('version');\n\n    if (!navigator.onLine) {\n      return;\n    }\n\n    params = Object.assign({}, params, {\n      v: 1,\n      aip: 1,\n      tid: this.tagId,\n      // cd: this.screenName,  // TODO: Add Screen Name.\n      cid: this.clientId,\n      dp: this.uri,\n      dh: this.dh,\n      dt: this.dt,\n      dr: this.dr,\n      p: this.p,\n      uip: this.remoteAddr,\n      an: this.xrAgentName,  // App Name.\n      av: this.xrAgentVersion,  // App Version.\n      aiid: ''  // TODO: Add App Installer ID.\n    });\n    params = Object.assign({}, params, this.consentedParams());\n    if (this.isTelemetryConsentChoice(params)) {\n      return this.request(`https://ssl.google-analytics.com/collect?${querystring.stringify(params)}`);\n    }\n  }\n\n  isTelemetryConsentChoice (params) {\n    return params.t === 'event' && params.ec === 'setting' && params.ea === 'settings.consent';\n  }\n\n  request (url) {\n    return post(url);\n  }\n\n  consentedParams () {\n    return {\n      sr: `${this.win.screen.width}x${this.win.screen.height}`,\n      vp: `${this.win.innerWidth}x${this.win.innerHeight}`,\n      dpr: getDevicePixelRatio(this.win),\n      capvr: !!this.win.navigator.getVRDisplays,\n      capxr: !!this.win.navigator.xr,\n      capgp: !!this.win.Gamepad,\n      capaudio: !!this.win.AudioContext || !!this.win.webkitAudioContext,\n      capwasm: !!this.win.WebAssembly,\n      capric: !!this.win.requestIdleCallback,\n      capwebgl: getWebGLCapabilities(this.win),\n      capwebgl2: getWebGL2Capabilities(this.win),\n      capworker: !!this.win.Worker,\n      capsw: !!this.win.navigator.serviceWorker,\n      caphc: this.win.navigator.hardwareConcurrency || 0,\n      capws: !!this.win.WebSocket || false,\n      capwebrtc: (!!this.win.RTCPeerConnection && !!this.win.RTCDataChannelEvent) || false,\n      capendian: getEndianness(this.win),\n      ua: getUserAgent(this.win)\n    };\n  }\n}\n\nexport default Reporter;\n","/* global location */\nimport LS from './storage.js';\nimport Reporter from './reporter.js';\n\nconst PathRE = /'?((\\/|\\\\|[a-z]:\\\\)[^\\s']+)+'?/ig;\nconst stripPath = msg => msg.replace(PathRE, '<path>');\n\nfunction uuidV4 () {\n  let uuid = '';\n  let idx;\n  let random;\n  for (ix = 0; idx < 32; idx++) {\n    random = Math.random() * 16 | 0;\n    if (idx === 8 || idx === 12 || idx === 16 || idx === 20) {\n      uuid += '-';\n    }\n    uuid += (idx == 12 ? 4 : (idx == 16 ? (random & 3 | 8) : random)).toString(16);\n  }\n  return uuid;\n}\n\nclass Metrics {\n  constructor (tagId, clientId, storage, reporter, win = window, doc = document) {\n    this.tagId = tagId;\n    this.clientId = clientId;\n    this.win = win || window;\n    this.doc = doc || document;\n    this.storage = storage || new LS(this.win, 'xrAgent.metrics.');\n    this.reporter = reporter || new Reporter(this.tagId, this.storage, this.win, this.doc);\n  }\n\n  activate (arg = {}) {\n    if (!this.reporter.hasConsented()) {\n      return false;\n    }\n    this.subscriptions = [];\n    let sessionLength = arg.sessionLength || Date.now();\n    return this.ensureClientId(((_this => () => _this.begin(sessionLength)))(this));\n  }\n\n  deactivate () {\n    delete this.subscriptions;\n    this.subscriptions = [];\n  }\n\n  serialize () {\n    return {\n      sessionLength: Date.now() - this.sessionStart\n    };\n  }\n\n  provideReporter () {\n    return {\n      sendEvent: this.reporter.sendEvent.bind(this.reporter),\n      sendTiming: this.reporter.sendTiming.bind(this.reporter),\n      sendException: this.reporter.sendException.bind(this.reporter)\n    };\n  }\n\n  begin (sessionLength) {\n    this.sessionStart = Date.now();\n    if (sessionLength) {\n      this.reporter.sendEvent('window', 'ended', null, sessionLength);\n    }\n    this.reporter.sendEvent('window', 'started');\n    this.watchExceptions();\n    this.watchPageView();\n  }\n\n  ensureClientId (callback) {\n    const self = this;\n    if (self.storage.get('clientId')) {\n      return callback();\n    }\n    return self.createClientId(clientId => {\n      self.storage.set('clientId', clientId);\n      return callback();\n    });\n  }\n\n  createClientId (callback) {\n    if (this.clientId) {\n      return callback(this.clientId);\n    }\n    return callback(uuidV4);\n  }\n\n  getClientId () {\n    return this.storage.get('clientId');\n  }\n\n  getTagId () {\n    if (this.tagId) {\n      return this.tagId;\n    }\n    this.tagId = this.storage.get('tagId');\n    return this.tagId;\n  }\n\n  setTagId (tagId) {\n    this.tagId = this.storage.set('tagId', tagId);\n    return tagId;\n  }\n\n  watchExceptions () {\n    return this.subscriptions.push(() => {\n      window.addEventListener('error', evt => {\n        let errMsg = evt;\n        if (typeof evt !== 'string') {\n          errMsg = evt.message;\n        }\n        errMsg = (stripPath(errMsg) || 'Unknown').replace('Uncaught ', '').slice(0, 150);\n        return self.reporter.sendException(errMsg);\n      });\n    });\n  }\n\n  watchPageView () {\n    const self = this;\n    return self.subscriptions.push(() => {\n      self.reporter.sendPageView(self.win.location.pathname, self.win.location.href, self.doc.title);\n    });\n  }\n}\n\nfunction getTag (scriptUrl, win, doc) {\n  win = win || window;\n  doc = doc || document;\n  scriptUrl = scriptUrl || doc.scriptURL || (doc.currentScript && doc.currentScript.src);\n  if (!scriptUrl && doc.currentScript) {\n    scriptUrl = doc.currentScript.getAttribute('data-tag');\n  }\n  if (!scriptUrl) {\n    return null;\n  }\n  try {\n    const qs = new win.URLSearchParams(new win.URL(scriptUrl).search);\n    return qs.get('tag');\n  } catch (err) {\n    return (scriptUrl.match(/[?&]tag=(.+)/i) || [])[1];\n  }\n}\n\nconst tagId = getTag(null, window, document);\nconst reporter = new Reporter(tagId, null, window, document);\nconst metrics = new Metrics(tagId, null, null, reporter, window, document);\nmetrics.activate();\n\nexport default metrics;\n"],"names":["LS","win","prefix","window","storage","localStorage","err","get","key","this","set","value","delete","clear","const","Reporter","tagId","doc","document","Error","consented","hasConsented","setTagId","saveConsent","removeConsent","remove","sendPageView","path","hostname","title","extraParams","send","sendEvent","category","action","label","params","el","ev","sendTiming","name","sendException","description","isSecureContext","location","protocol","port","sendCommand","commandName","base","commandCount","split","clientId","dp","uri","p","dh","host","dt","dr","referrer","uip","remoteAddr","xrAgentName","xrAgentVersion","navigator","onLine","Object","assign","consentedParams","isTelemetryConsentChoice","request","querystring","stringify","t","ec","ea","url","data","sendBeacon","let","xhr","XMLHttpRequest","open","post","screen","devicePixelRatio","getVRDisplays","xr","Gamepad","AudioContext","webkitAudioContext","WebAssembly","requestIdleCallback","canvas","createElement","gl","getContext","WebGLRenderingContext","getWebGLCapabilities","WebGL2RenderingContext","getWebGL2Capabilities","Worker","serviceWorker","hardwareConcurrency","WebSocket","RTCPeerConnection","RTCDataChannelEvent","ArrayBuffer","buffer","intView","Uint32Array","byteView","Uint8Array","getEndianness","userAgent","getUserAgent","PathRE","uuidV4","idx","random","uuid","ix","Math","toString","Metrics","reporter","activate","arg","subscriptions","_this","sessionLength","Date","now","ensureClientId","begin","deactivate","serialize","sessionStart","provideReporter","bind","watchExceptions","watchPageView","callback","self","createClientId","getClientId","getTagId","push","addEventListener","evt","msg","errMsg","message","replace","slice","pathname","href","scriptUrl","scriptURL","currentScript","src","getAttribute","URLSearchParams","URL","search","match","getTag","metrics"],"mappings":"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"}